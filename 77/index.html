<!DOCTYPE html>
<html lang="en"> <head><link rel="shortcut icon" href="/static/images/TechMonger%28CC%29.ico"><title>Postgres ODBC with Mutual SSL in Informatica - Tech Monger</title><meta charset="UTF-8"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="description" content="We will learn how to configure ODBC connection to use 2 way SSL using keystore and truststore certificates."><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="canonical" href="/77/odbc-ssl-postgres/"><style>.lead{font-size:1.25rem;font-weight:300}</style></head> <body> <div class="container"> <header class="container"> <h1 class="row"><a href="/">Tech Monger</a></h1> <p class="lead row">Programming, Web Development and Computer Science.</p> </header> <span id="skiplinks" class="skip-link"> <a href="#main" title="Main Content on Page">Skip to main content</a>| <a href="#sidebar" title="Sidebar of Blog">Skip to information by topic</a> </span> <div class="row"> <main class="col-lg-9" id="main"> <article class="container" itemscope itemtype="https://schema.org/BlogPosting"> <a href="/77/odbc-ssl-postgres/"> <h2 itemprop="headline">Postgres ODBC Connection with Mutual 2 Way SSL </h2> </a> <p itemprop="datePublished" title="20-07-01 14:36:42Z">Posted July 01, 2020</p> <div itemprop="articleBody"> <p class="lead">Encryption has become security norm and communicating with databases on insecure network should not be an exception to this norm. In this tutorial we will learn how to connect to postgres database using ODBC connection which is configured to use 2 way SSL connection.</p> <div class="card"> <div class="card-body"> <ol> <li><a href="#prerequisites">Prerequisites</a></li> <li><a href="#truststore-generation">TrustStore Generation</a></li> <li><a href="#truststore-validation">TrustStore Validation</a></li> <li><a href="#keystore-generation">Keystore Generation</a></li> <li><a href="#keystore-validation">Keystore Validation</a></li> <li><a href="#odbc-entry">ODBC Configuration</a></li> <li> <a href="#test">Testing Connection</a></li> </ol> </div> </div> <hr> <h3 id="prerequisites" class="top2">Prerequisites</h3> <p class="top2"> Before starting you should get certificate files in <code>.crt</code> format from the Postgres Database Admins. Certificates will be of 2 types : <code>Trustore</code> Certificate to validate server certificates using trusted certificate authority (CA) and <code>Keystore</code> certificates which will have private certificates to validate client. If above certificates are encrypted using key then you should also have key file in <code>.key</code> format. We will perform below configuration on Linux machine which has <code>openssl</code> installed in it. ODBC recognizes certificates in <code>.pfx</code> format and hence we will generate and export certificates in pfx file. </p> <hr> <h3 id="truststore-generation" class="top2">TrustStore Generation</h3> <p class="top2"> Export truststore certificates by creating new truststore or inside existing truststore with following command. You will need to provide password to create trustore. </p> <pre><code>$ openssl pkcs12 -export -in ca.crt -out pgtruststore.pfx -nokeys
Enter Export Password:
Verifying - Enter Export Password:</pre></code> <p class="top2"> Here <code>ca.crt</code> file would be provided by DBA and it will contain chain of certificates for the certification authority. Certificates will get exported inside file <code>pgtruststore.pfx</code>. Note that if you already have existing truststore file then you can export the certificates into the same by replacing filename <code>pgtruststore.pfx</code> with <code>your-truststore.pfx</code> </p> <hr> <h3 id="truststore-validation" class="top2">TrustStore Validation</h3> <p class="top2"> You can validate all the certificates are correctly exported inside your truststore with following command. Enter the same password which was created while generating truststore in previous step. </p> <pre><code>$ openssl pkcs12 -info -in pgtruststore.pfx
Enter Import Password:</pre></code> <hr> <h3 id="keystore-generation" class="top2">Keystore Generation</h3> <p class="top2"> Similar to truststore you will also need to create <em>unique</em> keystore with the keystore certificates and keys shared for the Postgres Client. You will be asked to set the password for the keystore file. </p> <pre><code>$ openssl pkcs12 -export -out pgkeystore.pfx -inkey pg.key -in pg.crt
Enter Export Password:
Verifying - Enter Export Password:
</pre></code> <p class="top2"> Here <code>pg.crt</code> and <code>pg.key</code> file would be provided by DBA & will contain encrypted postgres client certificates which will get exported inside file <code>pgkeystore.pfx</code>. </p> <hr> <h3 id="keystore-validation" class="top2">Keystore Validation</h3> <p class="top2"> You can validate all the postgres certificates are correctly exported inside in your keystore with following command. Enter the same password which was created while generating keystore in previous step. </p> <pre><code>$ openssl pkcs12 -info -in pgkeystore.pfx
Enter Import Password:</pre></code> <hr> <h3 id="odbc-entry" class="top2">ODBC Configuration</h3> <p class="top2"> Once you have correctly created keystore and trustore you can use the PFX file in ODBC configuration. ODBC entry will have same details as that of <a href="/75/informatica-denodo/" title="ODBC Entry Denodo">non-ssl database</a> however it will have additional flags like : <ul class="top2"> <li>ValidateServerCertificate: To validate Postgres Server Certificates</li> <li>EncryptionMethod: To have encrypted communication between client and server</li> <li>KeyStore : Absolute File Path to Keystore File</li> <li>KeyStorePassword : Import Password for the keystore</li> <li>TrustStore : Absolute File Path to Truststore File</li> <li>TrustStore Password : Import Password for the truststore</li> </ul> </p> <p>Below is the Example ODBC Entry with SSL</p> <pre><code>[POSTGRES_WITH_SSL]
Driver=/path/to/postgres/odbc/driver/library/DWpsql27.so
Description=PostgreSQL Wire Protocol
Database=POSTGRES_DB_NAME
HostName=postgres.example.com
PortNumber=5432
PacketSize=32
UserName=DB_USER
Password=*********************
EncryptionMethod=1
ValidateServerCertificate=1
KeyStore=/absolute/path/to/keystore/pgkeystore.pfx
KeyStorePassword=**************
TrustStore=/absolute/path/to/keystore/pgtruststore.pfx
TrustStorePassword=***************
</pre></code> <hr> <h3 id="test" class="top2">Testing Connection</h3> <p>Once you have created ODBC entry inside file <code>odbc.ini</code> then you can test the entry. If you are using tool like Informatica then it comes prebuilt with tool called <code>ssgodbc</code> to test ODBC connection. Using following command you should be able to test the connection. You shall get connected message if connection was successful. </p> <pre><code>ssgodbc.linux64  -d POSTGRES_WITH_SSL-u DB_USER -p *************** -v

Connected
ODBC version        = -03.10.0000-
DBMS name           = -PostgreSQL-
DBMS version        = -11.04.0001 PostgreSQL 11.4  (Centos 11.4 pgdg)
Driver name         = -DWpsql27.so-
Driver version      = -07.11
Driver ODBC version = -03.36-

Enter SQL string:
</pre></code> <hr> <h3>Conclusion</h3> <div class="card"> <p class="card-body"> We have connected to SSL Configured Postgres Database using ODBC connection. You can follow the same steps to connect to some other database using ODBC which uses mutual TLS authentication.<p> </p> </div> <p class="top3">Tagged Under :<span itemprop="keywords"> <a href="/tag/informatica/">Informatica</a> <a href="/tag/linux/">Linux</a> <a href="/tag/open-source/">Open Source</a> <a href="/tag/web/">Web</a> </span> </p> </article> <div class="top3"> <div class="col-sm-9"> <span class="float-left"> <a class="btn btn-secondary btn-md" role="button" aria-disabled="false" href="/76/key-based-ssh-error/" title="Fix Key Based SSH Authentication Error in Linux">Previous</a> </span> <span class="float-right"> <a class="btn btn-secondary btn-md disabled" role="button" aria-disabled="true" href="#">Next</a> </span> </div> </div> </main> <aside class="col-lg-3 top5" id="sidebar"> <div class="text-right"> <h3>Tags</h3> <nav> <ul> <li class="list-unstyled"><a href="/tag/davmail/" title="Davmail Setup and Configuration">Davmail</a></li> <li class="list-unstyled"><a href="/tag/flask/" title="Flask Web Development">Flask</a></li> <li class="list-unstyled"><a href="/tag/google-cloud/" title="Google Cloud Tutorials and Examples">Google Cloud</a></li> <li class="list-unstyled"><a href="/tag/informatica/" title="Informatica Administration Tutorials">Informatica</a></li> <li class="list-unstyled"><a href="/tag/linux/" title="Linux Desktop and Server - Tutorials">Linux</a></li> <li class="list-unstyled"><a href="/tag/localtunnel/" title="Localtunnel Tutorials -  HTTP Tunnel in Action">Localtunnel</a></li> <li class="list-unstyled"><a href="/tag/open-source/" title="Tutorials about open source software ">Open Source</a></li> <li class="list-unstyled"><a href="/tag/python/" title="Python Programming">Python</a></li> <li class="list-unstyled"><a href="/tag/raspberry-pi/" title="Raspberry Pi Tutorials and Hacks">Raspberry Pi</a></li> <li class="list-unstyled"><a href="/tag/thunderbird/" title="Thunderbird Tutorials">Thunderbird</a></li> <li class="list-unstyled"><a href="/tag/ubuntu/" title="Ubuntu Tutorials">Ubuntu</a></li> <li class="list-unstyled"><a href="/tag/web/" title="Tutorials for Full Stack Web Developers">Web</a></li> <li class="list-unstyled"><a href="/tag/windows/" title="Windows Software and Tutorials">Windows</a></li> <li class="list-unstyled"><a href="/tag/wordpress/" title="Wordpress Tutorials and Guides">Wordpress</a></li> </ul> </nav> </div> <div class="top4 bottom4 float-left"> <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script> <ins class="adsbygoogle" style="display:inline-block;width:336px;height:280px" data-ad-client="ca-pub-1476292113673713" data-ad-slot="8720400182"></ins> <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
        </script> <div> <div class="text-center"> <a class="top5" href="/feeds/" title="Atom Feed - Tech Monger"><i class="fa fa-rss" aria-hidden="true"></i>&nbsp;&nbsp;Feeds</a> </div> </aside> </div> <hr class="top3"> <footer class="top5 text-secondary"> <div class="container-fluid text-center text-md-left"> <div class="row"> <div class="col-md-4 mt-md-0 mt-3"> <h5 class="text-uppercase">About</h5> <p>Techmonger is a web log which shares interesting articles about computer science, programming and web development.</p> </div> <hr class="clearfix w-100 d-md-none pb-3"> <div class="col-md-3 mb-md-0 mb-3"> <h5 class="text-uppercase">Pages</h5> <ul class="list-unstyled"> <li> <a href="/privacy.html">Privacy Policy</a> </li> <li> <a href="/contact.html">Contact</a> </li> </ul> </div> <div class="col-md-5 mb-md-0 mb-3"> <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script> <ins class="adsbygoogle" style="display:inline-block;width:468px;height:60px" data-ad-client="ca-pub-1476292113673713" data-ad-slot="1929762560"></ins> <script>
            (adsbygoogle = window.adsbygoogle || []).push({});
            </script> </div> </div> </div> </footer> <div class="top3"></div> <link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.css"> <script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.js"></script> <script>
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#ffffff"
    },
    "button": {
      "background": "#e0e0e0",
      "text": "#0a0202"
    }
  },
  "theme": "edgeless",
  "content": {
    "dismiss": "Accept",
    "href": "/privacy.html"
  }
})});
</script> </div> <link rel="stylesheet" type="text/css" href="/static/css/style.css"> <script src="/static/js/scripts.js"></script> <script>hljs.initHighlightingOnLoad();</script> </body> </html>