<!DOCTYPE html>
<html lang="en"> <head><link rel="shortcut icon" href="/static/images/TechMonger%28CC%29.ico"><title>SOLVED : Authentication refused: bad ownership or modes for directory - Tech Monger</title><meta charset="UTF-8"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="description" content="In this tutorial we will learn how to resolve Key Based SSH, SFTP Login issue in Redhat Linux."><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="canonical" href="/76/key-based-ssh-error/"><style>.lead{font-size:1.25rem;font-weight:300}</style></head> <body> <div class="container"> <header class="container"> <h1 class="row"><a href="/">Tech Monger</a></h1> <p class="lead row">Programming, Web Development and Computer Science.</p> </header> <span id="skiplinks" class="skip-link"> <a href="#main" title="Main Content on Page">Skip to main content</a>| <a href="#sidebar" title="Sidebar of Blog">Skip to information by topic</a> </span> <div class="row"> <main class="col-lg-9" id="main"> <article class="container" itemscope itemtype="https://schema.org/BlogPosting"> <h2 itemprop="headline">Fix Key Based SSH Authentication Error in Linux</h2> <p itemprop="datePublished" title="19-12-06 17:49:47Z">Posted December 06, 2019</p> <div itemprop="articleBody"> <p class="lead"> If you have setup key based authentication between two different servers for SSH or SFTP then you might face issues while initiating SSH connection. Below we will see how to solve these issues by considering different failure vectors. We assume that you have already setup <code>authorized_keys</code> based keyless ssh login. </p> <h3 class="top2">Check directory and file permissions</h3> <p class="top1"> Permissions on the directory <code>~/.ssh/</code> and the files inside should be </p> <table class="table"> <tr> <th>File / Directory</th> <th>Permissions</th> <th>Numeric</th> </tr> <tr> <td>~/.ssh/</td> <td>drwx------</td> <td>700</td> </tr> <tr> <td>~/.ssh/id_rsa</td> <td>-rw-------</td> <td>600</td> </tr> <tr> <td>~/.ssh/username/id_rsa.pub</td> <td>-rw-r--r--</td> <td>644</td> </tr> <tr> <td>~/.ssh/authorized_keys</td> <td>-rw-r--r--</td> <td>644</td> </tr> <tr> <td>/etc/sshkeys/username</td> <td>-rw-r--r--</td> <td>644</td> </tr> </table> <p>If any of the above file have different permissions then you can change it with following commands.</p> <pre><code class="bash">chmod 700 ~/.ssh/
chmod 600 ~/.ssh/id_rsa
chmod 644 ~/.ssh/id_rsa.pub
chmod 644 ~/.ssh/authorized_keys
</code></pre> <p>Note that to modify file permission of <code>/etc/sshkeys/username</code>, you (user) should be the owner and should have write privilege on the file.</p> <hr> <h3 class="top2">Verify SSHD Configuration</h3> <p class="top1">If you have incorrect sshd configuration then key based authentication will not work. For example if you setup wrong value for the parameter <code>AuthorizedKeysFile</code> in sshd config file <code>/etc/ssh/sshd_config</code> then your key based authorization will fail. You would see following error inside <code>/var/log/secure</code>. </p> <p><strong><em>Authentication refused: bad ownership or modes for directory /home/username</em></strong></p> <p><code>AuthorizedKeysFile</code> should have following value inside <code>/etc/ssh/sshd_config</code>. <pre><code class="bash">AuthorizedKeysFile /etc/sshkeys/%u
</code></pre> </p> <p>If it is incorrect then please make modification as explained above. You will require root access to modify this file <code>/etc/ssh/sshd_config</code>. Also verify all other configuration against defaults set for your Linux distribution. </p> <p> You would require to restart <code>sshd</code> daemon after modification of <code>sshd_config</code>file. You can do it with root user using following command. </p> <ul> <li>Debian / Ubuntu <pre><code class="bash">sudo service ssh restart</code></pre> </li> <li>RHEL / CentOS <pre><code class="bash">sudo systemctl restart sshd</code></pre> </li> </ul> <hr> <h3>Conclusion</h3> <div class="card"> <p class="card-body"> We learned how to fix login error in password less ssh or sftp connections. Most errors occur due to the incorrect file permissions on ~/.ssh/ or due to the wrong sshd configuration. If you follow above tutorial then will face no issue with login, given that key based authentication setup has configured correctly. </p> </div> <p class="top3">Tagged Under :<span itemprop="keywords"> <a href="/tag/google-cloud/">Google Cloud</a> <a href="/tag/linux/">Linux</a> <a href="/tag/open-source/">Open Source</a> <a href="/tag/ubuntu/">Ubuntu</a> </span> </p> </article> <div class="top3"> <div class="col-sm-9"> <span class="float-left"> <a class="btn btn-secondary btn-md" role="button" aria-disabled="false" href="/75/informatica-denodo/" title="Install Denodo ODBC Driver in Linux Servers">Previous</a> </span> <span class="float-right"> <a class="btn btn-secondary btn-md disabled" role="button" aria-disabled="true" href="#">Next</a> </span> </div> </div> </main> <aside class="col-lg-3 top5" id="sidebar"> <div class="text-right"> <h3>Tags</h3> <nav> <ul> <li class="list-unstyled"><a href="/tag/davmail/" title="Davmail Setup and Configuration">Davmail</a></li> <li class="list-unstyled"><a href="/tag/flask/" title="Flask Web Development">Flask</a></li> <li class="list-unstyled"><a href="/tag/google-cloud/" title="Google Cloud Tutorials and Examples">Google Cloud</a></li> <li class="list-unstyled"><a href="/tag/informatica/" title="Informatica Administration Tutorials">Informatica</a></li> <li class="list-unstyled"><a href="/tag/linux/" title="Linux Desktop and Server - Tutorials">Linux</a></li> <li class="list-unstyled"><a href="/tag/localtunnel/" title="Localtunnel Tutorials -  HTTP Tunnel in Action">Localtunnel</a></li> <li class="list-unstyled"><a href="/tag/open-source/" title="Tutorials about open source software ">Open Source</a></li> <li class="list-unstyled"><a href="/tag/python/" title="Python Programming">Python</a></li> <li class="list-unstyled"><a href="/tag/raspberry-pi/" title="Raspberry Pi Tutorials and Hacks">Raspberry Pi</a></li> <li class="list-unstyled"><a href="/tag/thunderbird/" title="Thunderbird Tutorials">Thunderbird</a></li> <li class="list-unstyled"><a href="/tag/ubuntu/" title="Ubuntu Tutorials">Ubuntu</a></li> <li class="list-unstyled"><a href="/tag/web/" title="Tutorials for Full Stack Web Developers">Web</a></li> <li class="list-unstyled"><a href="/tag/windows/" title="Windows Software and Tutorials">Windows</a></li> <li class="list-unstyled"><a href="/tag/wordpress/" title="Wordpress Tutorials and Guides">Wordpress</a></li> </ul> </nav> </div> <div class="top4 bottom4 float-left"> <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script> <ins class="adsbygoogle" style="display:inline-block;width:336px;height:280px" data-ad-client="ca-pub-1476292113673713" data-ad-slot="8720400182"></ins> <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
        </script> <div> <div class="text-center"> <a class="top5" href="/feeds/" title="Atom Feed - Tech Monger"><i class="fa fa-rss" aria-hidden="true"></i>&nbsp;&nbsp;Feeds</a> </div> </aside> </div> <hr class="top3"> <footer class="top5 text-secondary"> <div class="container-fluid text-center text-md-left"> <div class="row"> <div class="col-md-4 mt-md-0 mt-3"> <h5 class="text-uppercase">About</h5> <p>Techmonger is a web log which shares interesting articles about computer science, programming and web development.</p> </div> <hr class="clearfix w-100 d-md-none pb-3"> <div class="col-md-3 mb-md-0 mb-3"> <h5 class="text-uppercase">Pages</h5> <ul class="list-unstyled"> <li> <a href="/privacy.html">Privacy Policy</a> </li> <li> <a href="/contact.html">Contact</a> </li> </ul> </div> <div class="col-md-5 mb-md-0 mb-3"> <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script> <ins class="adsbygoogle" style="display:inline-block;width:468px;height:60px" data-ad-client="ca-pub-1476292113673713" data-ad-slot="1929762560"></ins> <script>
            (adsbygoogle = window.adsbygoogle || []).push({});
            </script> </div> </div> </div> </footer> <div class="top3"></div> <link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.css"> <script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.js"></script> <script>
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#ffffff"
    },
    "button": {
      "background": "#e0e0e0",
      "text": "#0a0202"
    }
  },
  "theme": "edgeless",
  "content": {
    "dismiss": "Accept",
    "href": "/privacy.html"
  }
})});
</script> </div> <link rel="stylesheet" type="text/css" href="/static/css/style.css"> <script src="/static/js/scripts.js"></script> <script>hljs.initHighlightingOnLoad();</script> </body> </html>