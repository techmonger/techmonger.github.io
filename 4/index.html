<!DOCTYPE html>
<html lang="en"> <head><link rel="shortcut icon" href="/static/images/TechMonger%28CC%29.ico"><title>Secure Passwords in Python With Werkzeug - Tech Monger</title><meta charset="UTF-8"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="description" content="Learn how to store user passwords securely  using hashes, salts and HMAC with werkzeug."><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="canonical" href="/4/secure-passwords-werkzeug/"><style>.lead{font-size:1.25rem;font-weight:300}</style></head> <body> <div class="container"> <header class="container"> <h1 class="row"><a href="/">Tech Monger</a></h1> <p class="lead row">Programming, Web Development and Computer Science.</p> </header> <span id="skiplinks" class="skip-link"> <a href="#main" title="Main Content on Page">Skip to main content</a>| <a href="#sidebar" title="Sidebar of Blog">Skip to information by topic</a> </span> <div class="row"> <main class="col-lg-9" id="main"> <article class="container" itemscope itemtype="https://schema.org/BlogPosting"> <a href="/4/secure-passwords-werkzeug/"> <h2 itemprop="headline">How to store passwords securely using Werkzeug </h2> </a> <p itemprop="datePublished" title="17-11-26 09:38:45Z">Posted November 26, 2017</p> <div itemprop="articleBody"> <p class="lead">In this article we will learn how to implement secure user authentication system using python <code>werkzeug</code>. We will store secure passwords with salted hashes and later we will verify entered user password in plaintext against it's password hash to authenticate user.</p> <p><em>Werkzeug</em> is python library which contains lot of development and debugging tools for implementation of web application gateway interface(<code>WSGI</code>) applications. The good part is you can use this system not only for your web applications but also for standalone python applications like desktop apps, scripts, mobile apps and so on.</p> <h3>Install Werkzeug with pip</h3> <code class="hljs">pip install werkzeug</code> <div class="card top2"> <p class="text-info top2">Skip this step if you are using <code>flask</code> because flask will automatically install <code>werkzeug</code> as <code>werkzeug</code> is one of the dependency for <code>flask</code>.</p> </div> <h3 class="top2">Understanding Secure Passwords</h3> <p>Before we delve into the code it's good idea to zero in on <strong>what is secure password storage</strong>.</p> <div class="card"> <ul class="card-body"> <li>Passwords <b>will not be</b> stored as plaintext in database.</li> <li>Password will be stored as <b>hash</b> which is <em>irreversible</em> to plaintext. (one way hash).</li> <li>With given hash attacker <b>cannot</b> guess plaintext.</li> <li>Each user password will be hashed with <b>salt</b> to mitigate <em class="text-danger">rainbow table attacks</em>; Just in case if database got compromised.</li> </ul> </div> <h3 class="top2">Werkzeug Security Functions</h3> <p>There are various security functions available in the <code>werkzeug.security</code> but we are interested in <code>generate_password_hash</code> and <code> check_password_hash</code>.</p> <h4 class="top1">generate_password_hash</h4> <p><code>generate_password_hash</code> takes <b>plaintext password</b>, <b>hashing method</b> and <b>salt length</b> as an input to produce hashed password. By default it produces salt string with length 8. </p> <pre class="python"><code>from werkzeug.security import generate_password_hash
print generate_password_hash("P1ain-text-user-passw@rd", "sha256")
</code></pre> <code>sha256$lTsEjTVv$c794661e2c734903267fbc39205e53eca607f9ca2f85812c95020fe8afb3bc62</code> <p class="top2">Note that output string contains <b>hashing method</b>, <b>salt</b> and <b>hashed password</b> concatenated with the <code>$</code> (dolor). Store hashed string <b>as it is</b> in your database under column <b>hashed_password</b>.</p> <h4 class="top1">check_password_hash</h4> <p><code>check_password_hash</code> takes two inputs <b>password hash</b> and <b>plaintext password</b> and returns <code>True</code> if hash matches actual hash of plaintext password else returns <code>False</code> <pre class="python"><code>from werkzeug.security import check_password_hash

print check_password_hash("sha256$lTsEjTVv$c794661e2c734903267fbc39205e53eca607f9ca2f85812c95020fe8afb3bc62", "P1ain-text-user-passw@rd")

>> True
</code></pre> <pre class="python"><code>from werkzeug.security import check_password_hash

print check_password_hash("sha256$lTsEjTVv$c794661e2c734903267fbc39205e53eca607f9ca2f85812c95020fe8afb3bc62", "wrong-passw@rd")

>> False
</code></pre> <h3 class="top2">Conclusion</h3> <div class="card top2"> <div class="card-body"> <li class="top1">When you allow user to signup use <code>generate_password_hash</code> and store hashed version of password in database under column <b>hashed_pwd</b>.</li> <li class="top1"><strong>Do not store plaintext password.</strong></li> <li class="top1">When you authenticate user via sign in use <code>check_password_hash</code> by passing already <b>hashed password</b> for user from database and <b>input password</b> (plaintext) to test veracity of password.</li> </div> </div> <p class="top3">Tagged Under :<span itemprop="keywords"> <a href="/tag/flask/">Flask</a> <a href="/tag/python/">Python</a> <a href="/tag/web/">Web</a> </span> </p> </article> <div class="top3"> <div class="col-sm-9"> <span class="float-left"> <a class="btn btn-secondary btn-md" role="button" aria-disabled="false" href="/3/linux-windows-ftp/" title="File transfer between ubuntu and windows using VSFTP">Previous</a> </span> <span class="float-right"> <a class="btn btn-secondary btn-md" role="button" aria-disabled="false" href="/5/python-flask-recaptcha/" title="How to add ReCaptcha to Flask App without Extension">Next</a> </span> </div> </div> </main> <aside class="col-lg-3 top5" id="sidebar"> <div class="text-right"> <h3>Tags</h3> <nav> <ul> <li class="list-unstyled"><a href="/tag/davmail/" title="Davmail Setup and Configuration">Davmail</a></li> <li class="list-unstyled"><a href="/tag/flask/" title="Flask Web Development">Flask</a></li> <li class="list-unstyled"><a href="/tag/google-cloud/" title="Google Cloud Tutorials and Examples">Google Cloud</a></li> <li class="list-unstyled"><a href="/tag/informatica/" title="Informatica Administration Tutorials">Informatica</a></li> <li class="list-unstyled"><a href="/tag/linux/" title="Linux Desktop and Server - Tutorials">Linux</a></li> <li class="list-unstyled"><a href="/tag/localtunnel/" title="Localtunnel Tutorials -  HTTP Tunnel in Action">Localtunnel</a></li> <li class="list-unstyled"><a href="/tag/open-source/" title="Tutorials about open source software ">Open Source</a></li> <li class="list-unstyled"><a href="/tag/python/" title="Python Programming">Python</a></li> <li class="list-unstyled"><a href="/tag/raspberry-pi/" title="Raspberry Pi Tutorials and Hacks">Raspberry Pi</a></li> <li class="list-unstyled"><a href="/tag/thunderbird/" title="Thunderbird Tutorials">Thunderbird</a></li> <li class="list-unstyled"><a href="/tag/ubuntu/" title="Ubuntu Tutorials">Ubuntu</a></li> <li class="list-unstyled"><a href="/tag/web/" title="Tutorials for Full Stack Web Developers">Web</a></li> <li class="list-unstyled"><a href="/tag/windows/" title="Windows Software and Tutorials">Windows</a></li> <li class="list-unstyled"><a href="/tag/wordpress/" title="Wordpress Tutorials and Guides">Wordpress</a></li> </ul> </nav> </div> <div class="top2 float-left"> <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script> <ins class="adsbygoogle" style="display:inline-block;width:336px;height:280px" data-ad-client="ca-pub-1476292113673713" data-ad-slot="8720400182"></ins> <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
        </script> <div> <div class="text-center"> <a class="top3" href="/feeds/" title="Atom Feed - Tech Monger"><i class="fa fa-rss" aria-hidden="true"></i>&nbsp;&nbsp;Feeds</a> </div> </aside> </div> <hr class="top3"> <footer class="top5 text-secondary"> <div class="container-fluid text-center text-md-left"> <div class="row"> <div class="col-md-4 mt-md-0 mt-3"> <h5 class="text-uppercase">About</h5> <p>Techmonger is a web log which shares interesting articles about computer science, programming and web development.</p> </div> <hr class="clearfix w-100 d-md-none pb-3"> <div class="col-md-3 mb-md-0 mb-3"> <h5 class="text-uppercase">Pages</h5> <ul class="list-unstyled"> <li> <a href="/privacy.html">Privacy Policy</a> </li> <li> <a href="/contact.html">Contact</a> </li> </ul> </div> <div class="col-md-5 mb-md-0 mb-3"> <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script> <ins class="adsbygoogle" style="display:inline-block;width:468px;height:60px" data-ad-client="ca-pub-1476292113673713" data-ad-slot="1929762560"></ins> <script>
            (adsbygoogle = window.adsbygoogle || []).push({});
            </script> </div> </div> </div> </footer> <div class="top3"></div> <link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.css"> <script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.js"></script> <script>
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#ffffff"
    },
    "button": {
      "background": "#e0e0e0",
      "text": "#0a0202"
    }
  },
  "theme": "edgeless",
  "content": {
    "dismiss": "Accept",
    "href": "/privacy.html"
  }
})});
</script> </div> <link rel="stylesheet" type="text/css" href="/static/css/style.css"> <script src="/static/js/scripts.js"></script> <script>hljs.initHighlightingOnLoad();</script> </body> </html>