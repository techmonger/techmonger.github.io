<!DOCTYPE html>
<html lang="en"> <head><link rel="shortcut icon" href="/static/images/TechMonger%28CC%29.ico"><title>How Password Hashing Works in Ubuntu Linux - Tech Monger</title><meta charset="UTF-8"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="description" content="Learn how user passwords are stored in ubuntu and understand how password hashing works with example in python."><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="canonical" href="/74/linux-password-hashing/"><style>.lead{font-size:1.25rem;font-weight:300}</style></head> <body> <div class="container"> <header class="container"> <h1 class="row"><a href="/">Tech Monger</a></h1> <p class="lead row">Programming, Web Development and Computer Science.</p> </header> <span id="skiplinks" class="skip-link"> <a href="#main" title="Main Content on Page">Skip to main content</a>| <a href="#sidebar" title="Sidebar of Blog">Skip to information by topic</a> </span> <div class="row"> <main class="col-lg-9" id="main"> <article class="container" itemscope itemtype="https://schema.org/BlogPosting"> <a href="/74/linux-password-hashing/"> <h2 itemprop="headline">Ubuntu Password Storage and Hashing with Python </h2> </a> <p itemprop="datePublished" title="19-07-06 12:42:06Z">Posted July 06, 2019</p> <div itemprop="articleBody"> <p class="lead"> If you ever wondered where and how user passwords are stored in linux file system then this post will answer most of your questions. Below we will discuss password hashing in ubuntu but many other linux distributions follow this pattern. Below read assumes that you have basic familiarity with hash function like md5 or sha-256. </p> <hr> <h3 class="top2">Hashed not Encrypted</h3> <p>In Linux Passwords are not stored by encrypting with some secret key rather <strong><em>hash of the password</em></strong> is stored. So you need not to worry about key getting compromised nor the file which actually stores password (Hashed Password) getting stolen. </p> <p>To make storage more secure password are hashed with salt. Salt is just random string which is generated when you create password. This helps prevent <em>rainbow table attacks</em>. </p> <hr> <h3 class="top2">Password File Location and Content</h3> <p> Ubuntu stores password content in file <code>/etc/shadow</code>. Only root user can write inside this file. Along with hashed password this file also stores content like username, password change date, expiry date etc. in colon (:) separated format. We will focus on the second field i.e <em>salt with hashed password</em>. </p> <hr> <pre class="bash"><code>$ sudo cat /etc/shadow/

techmonger:$6$ABCD1234$JnCx/.NCi4315V0AONxuVpUIRvPivoQjLzY0M28iYkOJU/FwVhXE4Me2f72fldvGEOpnTAB7IuVrsVfwpT/XT/:38478:0:99999:5:::
</code></pre> <hr> <p>This line stores salt along with password hash. Note that each string between <strong>$</strong> sign represent following things.</p> <p> <small> <b> $<span class="text-warning">6</span>$<span class="text-danger">ABCD1234</span>$<span class="text-success">JnCx/.NCi4315V0AONxuVpUIRvPivoQjLzY0M28iYkOJU/FwVhXE4Me2f72fldvGEOpnTAB7IuVrsVfwpT/XT/</span> </b> </small> </p> <table class="table"> <tr> <th> Value </th> <th> Explanation </th> </tr> <tr> <td><code>$6$</code> </td> <td> Value between starting two $ sign represents algorithm used for hashing. Here number 6 suggests sha-512 been used. </td> </tr> <tr> <td><code>$ABCD1234$</code></td> <td> Value between second and third $ sign represents string salt which is used for hashing.. </td> </tr> <tr> <td><code> $JnCx/.NCi4315V0AON xuVpUIRvPivoQjLzY0M 28iYkOJU/FwVhXE4Me 2f72fldvGEOpnTAB7IuV rsVfwpT/XT/</code> </td> <td> Value after the third $ sign represents actual hashed password. </td> </tr> </table> <hr> <h3 class="top2">Regenerating Hashed Password in Python</h3> <p> Stored password hash is generated using <code>crypt3</code>. You can use python crypt implementation to regenerate password. Note that the password used for the user <code>techmonger</code> is <code>hunter2</code>. </p> <pre class="python">
<code>>>> import crypt
>>> password="hunter2"
>>> hashing_scheme_with_salt="$6$ABCD1234$"
>>> crypt.crypt(password, hashing_scheme_with_salt)
'$6$ABCD1234$JnCx/.NCi4315V0AONxuVpUIRvPivoQjLzY0M28iYkOJU/FwVhXE4Me2f72fldvGEOpnTAB7IuVrsVfwpT/XT/'
</code>
</pre> <p>In above example you can see that hash value generated by hashing password <strong>hunter2</strong> with salt <strong>ABCD1234</strong> using <strong>sha-512</strong> is same as that present in the file <code>/etc/shadow</code>. <p> <hr> <h3 class="top2">Conclusion</h3> <div class="card"> <p class="card-body"> Above we have seen how password is stored in Linux like system and how hashed password is generated with the help of python code. Storing password this way is very secure and finding actual password from the stored hash is <em>impossible</em>*. </p> </div> </div> <p class="top3">Tagged Under :<span itemprop="keywords"> <a href="/tag/linux/">Linux</a> <a href="/tag/python/">Python</a> <a href="/tag/ubuntu/">Ubuntu</a> </span> </p> </article> <div class="top3"> <div class="col-sm-9"> <span class="float-left"> <a class="btn btn-secondary btn-md" role="button" aria-disabled="false" href="/73/crash-auto-restart/" title="Auto Restart Web Server After Crash">Previous</a> </span> <span class="float-right"> <a class="btn btn-secondary btn-md" role="button" aria-disabled="false" href="/75/informatica-denodo/" title="Install Denodo ODBC Driver in Linux Servers">Next</a> </span> </div> </div> </main> <aside class="col-lg-3 top5" id="sidebar"> <div class="text-right"> <h3>Tags</h3> <nav> <ul> <li class="list-unstyled"><a href="/tag/davmail/" title="Davmail Setup and Configuration">Davmail</a></li> <li class="list-unstyled"><a href="/tag/flask/" title="Flask Web Development">Flask</a></li> <li class="list-unstyled"><a href="/tag/google-cloud/" title="Google Cloud Tutorials and Examples">Google Cloud</a></li> <li class="list-unstyled"><a href="/tag/informatica/" title="Informatica Administration Tutorials">Informatica</a></li> <li class="list-unstyled"><a href="/tag/linux/" title="Linux Desktop and Server - Tutorials">Linux</a></li> <li class="list-unstyled"><a href="/tag/localtunnel/" title="Localtunnel Tutorials -  HTTP Tunnel in Action">Localtunnel</a></li> <li class="list-unstyled"><a href="/tag/open-source/" title="Tutorials about open source software ">Open Source</a></li> <li class="list-unstyled"><a href="/tag/python/" title="Python Programming">Python</a></li> <li class="list-unstyled"><a href="/tag/raspberry-pi/" title="Raspberry Pi Tutorials and Hacks">Raspberry Pi</a></li> <li class="list-unstyled"><a href="/tag/thunderbird/" title="Thunderbird Tutorials">Thunderbird</a></li> <li class="list-unstyled"><a href="/tag/ubuntu/" title="Ubuntu Tutorials">Ubuntu</a></li> <li class="list-unstyled"><a href="/tag/web/" title="Tutorials for Full Stack Web Developers">Web</a></li> <li class="list-unstyled"><a href="/tag/windows/" title="Windows Software and Tutorials">Windows</a></li> <li class="list-unstyled"><a href="/tag/wordpress/" title="Wordpress Tutorials and Guides">Wordpress</a></li> </ul> </nav> </div> <div class="top4 bottom4 float-left"> <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script> <ins class="adsbygoogle" style="display:inline-block;width:336px;height:280px" data-ad-client="ca-pub-1476292113673713" data-ad-slot="8720400182"></ins> <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
        </script> <div> <div class="text-center"> <a class="top5" href="/feeds/" title="Atom Feed - Tech Monger"><i class="fa fa-rss" aria-hidden="true"></i>&nbsp;&nbsp;Feeds</a> </div> </aside> </div> <hr class="top3"> <footer class="top5 text-secondary"> <div class="container-fluid text-center text-md-left"> <div class="row"> <div class="col-md-4 mt-md-0 mt-3"> <h5 class="text-uppercase">About</h5> <p>Techmonger is a web log which shares interesting articles about computer science, programming and web development.</p> </div> <hr class="clearfix w-100 d-md-none pb-3"> <div class="col-md-3 mb-md-0 mb-3"> <h5 class="text-uppercase">Pages</h5> <ul class="list-unstyled"> <li> <a href="/privacy.html">Privacy Policy</a> </li> <li> <a href="/contact.html">Contact</a> </li> </ul> </div> <div class="col-md-5 mb-md-0 mb-3"> <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script> <ins class="adsbygoogle" style="display:inline-block;width:468px;height:60px" data-ad-client="ca-pub-1476292113673713" data-ad-slot="1929762560"></ins> <script>
            (adsbygoogle = window.adsbygoogle || []).push({});
            </script> </div> </div> </div> </footer> <div class="top3"></div> <link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.css"> <script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.js"></script> <script>
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#ffffff"
    },
    "button": {
      "background": "#e0e0e0",
      "text": "#0a0202"
    }
  },
  "theme": "edgeless",
  "content": {
    "dismiss": "Accept",
    "href": "/privacy.html"
  }
})});
</script> </div> <link rel="stylesheet" type="text/css" href="/static/css/style.css"> <script src="/static/js/scripts.js"></script> <script>hljs.initHighlightingOnLoad();</script> </body> </html>