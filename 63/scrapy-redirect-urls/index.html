<!DOCTYPE html>
<html lang="en"> <head><link rel="shortcut icon" href="/static/images/TechMonger%28CC%29.ico"><title>Scrapy Get Redirect URLs and Request URL - Tech Monger</title><meta charset="UTF-8"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="description" content="Learn how can you obtain requested url by Scrapy spider inside parse method."><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="canonical" href="/63/scrapy-redirect-urls/"><style>.lead{font-size:1.25rem;font-weight:300}</style></head> <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script> <script>
     (adsbygoogle = window.adsbygoogle || []).push({
          google_ad_client: "ca-pub-1476292113673713",
          enable_page_level_ads: true
     });
</script> <body> <div class="container"> <header class="container"> <h1 class="row"><a href="/">Tech Monger</a></h1> <p class="lead row">Programming, Web Development and Computer Science.</p> </header> <span id="skiplinks" class="skip-link"> <a href="#main" title="Main Content on Page">Skip to main content</a>| <a href="#sidebar" title="Sidebar of Blog">Skip to information by topic</a> </span> <div class="row"> <main class="col-lg-10" id="main"> <article class="container" itemscope itemtype="https://schema.org/BlogPosting"> <h2 itemprop="headline">Get Currently Requested URL From Scrapy Spider</h2> <p itemprop="datePublished" title="18-11-09 13:46:24Z">Posted November 09, 2018</p> <div itemprop="articleBody"> <p class="lead"> If you ever wanted to figure out all the redirect urls that scrapy spider hopped on or what is the currently requested URL by the spider then you easily get that using following <a href="#example">example code</a>. </p> <hr> <h3 class="top3">Scrapy's Response Object</h3> <p class="top2">When you start scrapy spider for crawling, it stores response details of each url that spider requested inside <code>response</code> object . The good part about this object is it remains available inside <code>parse</code> method of the spider class. You can also access response object while using <em>scrapy shell</em>. </p> <p class="top1">Response object stores information about current request inside <code>request</code> object which is also available inside <code>response.request</code> object . <code>response.request</code> object holds useful information such as <strong>currently requested url</strong> or meta information such as all the <strong>redirect urls followed during current request.</strong> This information comes handy when we want to retrieve <strong>first redirected url</strong> or currently requested url. </p> <hr> <h3 id="example" class="top3">Examples</h3> <ul class="top2"> <p><li class="top1">Get Currently Requested URL</p> <pre class="python"><code>def parse(self, response):
   current_url = response.request.url</code></pre> </li> <p><li class="top1">Get All Followed Redirect URLs</p> <pre class="python"><code>def parse(self, response):
   redirect_url_list = response.request.meta.get('redirect_urls')</code></pre> </li> <p><li class="top1">Get First URL Followed by Spiders <br>(Actual request url provided in <code>start_urls</code> or in <code>start_requests</code>) Redirect URLs)</p> <pre class="python"><code>def parse(self, response):
   redirect_url_list = response.request.meta.get('redirect_urls')[0]</code></pre> </li> <p><li class="top1">If there is no redirect followed during crawl then above code will fail with <strong>KeyError: 'redirect_urls'</strong>. Below code would safely extract first requested url.</p> <pre class="python"><code>if response.request.meta.get('redirect_urls'):
    url = response.request.meta['redirect_urls'][0]
else:
    url = response.request.url</code></pre> </li> </ul> </div> <p class="top3">Tagged Under :<span itemprop="keywords"> <a href="/tag/open-source/">Open Source</a> <a href="/tag/python/">Python</a> <a href="/tag/scrapy/">Scrapy</a> </span> </p> </article> <div class="top3"> <div class="col-sm-9"> <span class="float-left"> <a class="btn btn-secondary btn-md" role="button" aria-disabled="false" href="/62/example-scrapy-fake-user-agent/" title="Configure Fake User Agent  in Scrapy Project">Previous</a> </span> <span class="float-right"> <a class="btn btn-secondary btn-md" role="button" aria-disabled="false" href="/64/wtf-custom-validation-hack/" title="Integrate Custom Validation in WTForms using Flask">Next</a> </span> </div> </div> </main> <aside class="col-lg-2 top5" id="sidebar"> <h3>Tags</h3> <nav> <ul> <li><a href="/tag/davmail/" title="Davmail Setup and Configuration">Davmail</a></li> <li><a href="/tag/flask/" title="Flask Web Development">Flask</a></li> <li><a href="/tag/google-cloud/" title="Google Cloud Tutorials and Examples">Google Cloud</a></li> <li><a href="/tag/informatica/" title="Informatica Administration Tutorials">Informatica</a></li> <li><a href="/tag/linux/" title="Linux Desktop and Server - Tutorials">Linux</a></li> <li><a href="/tag/localtunnel/" title="Localtunnel Tutorials -  HTTP Tunnel in Action">Localtunnel</a></li> <li><a href="/tag/open-source/" title="Tutorials about open source software ">Open Source</a></li> <li><a href="/tag/python/" title="Python Programming">Python</a></li> <li><a href="/tag/raspberry-pi/" title="Raspberry Pi Tutorials and Hacks">Raspberry Pi</a></li> <li><a href="/tag/thunderbird/" title="Thunderbird Tutorials">Thunderbird</a></li> <li><a href="/tag/ubuntu/" title="Ubuntu Tutorials">Ubuntu</a></li> <li><a href="/tag/web/" title="Tutorials for Full Stack Web Developers">Web</a></li> <li><a href="/tag/windows/" title="Windows Software and Tutorials">Windows</a></li> <li><a href="/tag/wordpress/" title="Wordpress Tutorials and Guides">Wordpress</a></li> </ul> </nav> <a href="/feeds/" title="Atom Feed - Tech Monger"><i class="fa fa-rss" aria-hidden="true"></i>&nbsp;&nbsp;Feeds</a> </aside> </div> <hr class="top3"> <footer class="top5 text-secondary"> <div class="container-fluid text-center text-md-left"> <div class="row"> <div class="col-md-6 mt-md-0 mt-3"> <h5 class="text-uppercase">About</h5> <p>Techmonger is a web log which shares interesting articles about computer science, programming and web development.</p> </div> <hr class="clearfix w-100 d-md-none pb-3"> <div class="col-md-3 mb-md-0 mb-3"> <h5 class="text-uppercase">Pages</h5> <ul class="list-unstyled"> <li> <a href="/privacy.html">Privacy Policy</a> </li> <li> <a href="/contact.html">Contact</a> </li> </ul> </div> </div> </div> </footer> <div class="top3"></div> <link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.css"> <script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.js"></script> <script>
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#ffffff"
    },
    "button": {
      "background": "#e0e0e0",
      "text": "#0a0202"
    }
  },
  "theme": "edgeless",
  "content": {
    "dismiss": "Accept",
    "href": "/privacy/"
  }
})});
</script> </div> <link rel="stylesheet" type="text/css" href="/static/css/style.css"> <script src="/static/js/scripts.js"></script> <script>hljs.initHighlightingOnLoad();</script> </body> </html>