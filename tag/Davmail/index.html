<!DOCTYPE html>
<html lang="en"> <head><link rel="shortcut icon" href="/static/images/TechMonger%28CC%29.ico"><title>Davmail Setup and Configuration - Tech Monger</title><meta charset="UTF-8"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="description" content="Learn how to setup free and open source davmail and thunderbird to communicate with microsoft exchange mail server."><meta name="viewport" content="width=device-width, initial-scale=1"></head> <body> <div class="container"> <header class="container"> <h1 class="row"><a href="/">Tech Monger</a></h1> <p class="lead row">Programming, Web Development and Computer Science.</p> </header> <span id="skiplinks" class="skip-link"> <a href="#main" title="Main Content on Page">Skip to main content</a>| <a href="#sidebar" title="Sidebar of Blog">Skip to information by topic</a> </span> <div class="row"> <main class="col-lg-10" id="main"> <h3>Tagged Under : Davmail</h3> <article class="container top2" itemscope itemtype="https://schema.org/BlogPosting"> <h2><a href="/9/thunderbird-exchange-davmail/">Configure Outlook in Thunderbird with Davmail</a></h2> <p title="17-12-08 18:38:24Z">Posted December 08, 2017</p> <p class="lead">In previous posts we have installed davmail on both <a href="/7/davmail-linux/" title="DavMail Installation on Linux">Linux</a> and <a href="/8/davmail-windows" title="DavMail Installation on Microsoft Windows">Windows</a>; In this article we will configure DavMail with MS Exchange server and access emails on Thunderbird. This setup will eliminate need of MS Outlook; If you are not sure about this setup then read <a href="/6/exchange-davmail/" title="What is DavMail">why we need DavMail</a>. If you have already installed it then you would see following configuration interface from DavMail. </p> <div class="row"> <div class="col-lg-6"> <figure class="figure  top3 text-center"> <img class="img-fluid  float-left" src="/static/images/7/linux-davmail-exchange-configuration.png" alt="Davmail Exchange Configuration Window in Ubuntu"> <figcaption>Davmail Exchange Setup Linux</figcaption> </figure> </div> <div class="col-lg-6"> <figure class="figure  top3 text-center"> <img class="img-fluid  float-right" src="/static/images/8/6-davmail-default-config.png" alt="Davmail Exchange Configuration Window"> <figcaption>Davmail Exchange Setup Window</figcaption> </figure> </div> </div> <h3>DavMail Exchange Setup</h3> <div id="accordion" role="tablist"> <div class="card"> <div class="card-header" role="tab" id="main-config"> <h4 class="mb-0"> <a data-toggle="collapse" href="#collapseOne" aria-expanded="true" aria-controls="collapseOne"> Main Setting </a> </h4> </div> <div id="collapseOne" class="collapse show" role="tabpanel" aria-labelledby="headingOne" data-parent="#accordion"> <div class="card-body"> <table class="table table-striped"> <thead class="text-center"> <tr> <th>Option</th> <th>Usage</th> <th>Values</th> </tr> </thead> <tbody> <tr> <th scope="row">Exchange Protocol</th> <td>Till version 2007 exchange supported both EWS and WebDav. However microsoft discontinued WebDav from 2007 hence Configure DavMail with EWS.</td> <td>EWS</td> </tr> <tr> <th scope="row">Exchange URL</th> <td>From this URL endpoint DavMail communicates with an exchange server using EWS. To test this you can open URL in browser to get login prompt for server.</td> <td>https://mail.example.com/EWS/Exchange.asmx</td> </tr> <tr> <th scope="row">Ports and Delay</th> <td>Keep delay and all port values default unless you have some other service running on default ports.</td> <td><i>Defaults</i></td> </tr> </tbody> </table> <div class="card alert-danger"> <p class="card-body">Finding Exchange URL is the <strong>trickiest part</strong> while configuring the davmail because different versions of exchange server support different url endpoints. You may want to try several URL's during configuration to get up and running with davmail. </div> </div> </div> </div> <div class="card"> <div class="card-header" role="tab" id="headingTwo"> <h4 class="mb-0"> <a class="collapsed" data-toggle="collapse" href="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo"> Network Setting </a> </h4> </div> <div id="collapseTwo" class="collapse" role="tabpanel" aria-labelledby="headingTwo" data-parent="#accordion"> <div class="card-body"> <p class="top2">If you are using corporate exchange mail server then most probably it would be running behind <code><abbr title="Virtual Private Network">VPN</abbr></code> and must have <code>HTTP/HTTPS</code> proxy setup. In order to make connection with server from <strong>outside office network</strong> you should <strong>first get into VPN</strong> and <strong>configure proxy setting</strong> in a DavMail. You can get to know your proxy address and port from browser. Search for <kbd>proxy</kbd> inside browser settings. If you don't know your proxy settings then try with System Proxy or get proxy details from System Admin. </p> <table class="table table-striped"> <thead class="text-center"> <tr> <th>Option</th> <th>Usage</th> <th>Values</th> </tr> </thead> <tbody> <tr> <th scope="row">Use System Proxy Settings</th> <td>Check this if you want to use system level proxy.</td> <td>NA</td> </tr> <tr> <th scope="row">Enable Proxy</th> <td>Check this If you want to enter manual proxy details.</td> <td>NA</td> </tr> <tr> <th scope="row">Proxy Address, Port, Username, Password</th> <td>Details for manual proxy.</td> <td>Valid Proxy IP Address or Domain Name, Proxy Port, Proxy Username, Proxy Password.</td> </tr> <tr> <th scope="row">Network Detail</th> <td>Keep network details default unless you are doing advance server configuration with encryption.</td> <td><i>Defaults</i></td> </tr> </tbody> </table> </div> </div> </div> <div class="card"> <div class="card-header" role="tab" id="headingThree"> <h4 class="mb-0"> <a class="collapsed" data-toggle="collapse" href="#collapseThree" aria-expanded="false" aria-controls="collapseThree"> Encryption </a> </h4> </div> <div id="collapseThree" class="collapse" role="tabpanel" aria-labelledby="headingThree" data-parent="#accordion"> <div class="card-body"> <p class="top2">By default DavMail does not encrypt network traffic between DavMail and Mail Client (thunderbird). It does not matter much if you are running DavMail and mail client <strong>on the same system</strong>. However if you are using Davmail as Standalone Server then you may want to configure encryption for local traffic. <b>Do not confuse</b> this encryption setting with the one with exchange server. If you are using <code>HTTPS</code> url endpoint then traffic between your computer and exchange server is <em>encrypted</em>. </p> </div> </div> </div> <div class="card"> <div class="card-header" role="tab" id="headingFour"> <h4 class="mb-0"> <a class="collapsed" data-toggle="collapse" href="#collapseFour" aria-expanded="false" aria-controls="collapseThree"> Logging </a> </h4> </div> <div id="collapseFour" class="collapse" role="tabpanel" aria-labelledby="headingFour" data-parent="#accordion"> <div class="card-body"> <p class="top2"> After installing davmail it will create <code>davmail.log</code> file inside installation directory or home directory. It's useful to have known location for log file with specific max size to troubleshoot any issue in future. Default log levels will serve your purpose. </p> <table class="table table-striped"> <thead class="text-center"> <tr> <th>Option</th> <th>Usage</th> <th>Values</th> </tr> </thead> <tbody> <tr> <th scope="row">Log File Path</th> <td>Path where log file will be saved</td> <td>Installation Directory</td> </tr> <tr> <th scope="row">Log File Size</th> <td>Maximum log file size. After max size logs will be rotated.</td> <td>5MB</td> </tr> </tbody> </table> </div> </div> </div> <div class="card"> <div class="card-header" role="tab" id="headingFive"> <h4 class="mb-0"> <a class="collapsed" data-toggle="collapse" href="#collapseFive" aria-expanded="false" aria-controls="collapseFive"> Advanced </a> </h4> </div> <div id="collapseFive" class="collapse" role="tabpanel" aria-labelledby="headingFive" data-parent="#accordion"> <div class="card-body"> <p class="top2"> We will go with default advanced setting as it will serve basic purpose of sending and receiving mails however you can tweak it as needed in future. </p> </div> </div> </div> </div> <p class="lead top3">We have configured an account for outlook.com in Davmail. After configuration our main setting look like below. Note that following URL endpoint is used. We have not configured anything other than Main Settings by keeping everything else Default.</p> <code>https://outlook.office365.com/EWS/Exchange.asmx</code> <figure class="figure  top3 text-center"> <img class="img-fluid  float-left" src="/static/images/9/outlook-365-davmail.png" alt="Davmail Exchange Configuration For Office 365"> <figcaption>Davmail Outlook Configuration</figcaption> </figure> <h3 class="top3">DavMail Thunderbird Setup</h4> <p>Now we have configured davmail with outlook exchange server we can use Thunderbird to send and receive mails.</p> <ol> <li> <p>Create a new account in thunderbird from <kbd>File</kbd>, <kbd>New</kbd>, <kbd>Existing Mail Account</kbd>. And provide <em>Your Name</em>, <em>Outlook Email Address</em>, and <em>Outlook Password</em>.</p> <figure class="figure  top3 text-center"> <img class="img-fluid  float-left" src="/static/images/9/tb-new-account.png" alt="Thunderbird  Configure Existing Mail Account"> <figcaption>Thunderbird Mail Account For Outlook</figcaption> </figure> </li> <li> <p>Click Continue and select manual config to provide Following DavMail details.</p> <table class="table"> <tr> <th>Hostname</th> <th>Protocol</th> <th>Port Number</th> <th>SSL</th> <th>Authentication</th> </tr> <tr> <td>localhost</td> <td>POP</td> <td>1110</td> <td>None</td> <td>Normal Password</td> </tr> <tr> <td>localhost</td> <td>IMAP</td> <td>1143</td> <td>None</td> <td>Normal Password</td> </tr> <tr> <td>localhost</td> <td>SMTP</td> <td>1025</td> <td>None</td> <td>Normal Password</td> </tr> </table> <div class="card"> <p> <ul> <li class="top2">Note that by default <code>POP</code> is not enabled with outlook but you can activate it from outlook mail settings (Options - Accounts - POP and IMAP). </li> <li class="top2"> You can either configure <code>IMAP</code> or <code>POP</code> in thunderbird with single account. </li> <li class="top2">However you create two seperate accounts for <code>IMAP</code> and <code>POP</code> </li> <li class="top2"> While configuring account both incoming and outgoing username should be same as email address. </li> </p> </div> <figure class="figure  top3 text-center"> <img class="img-fluid  float-left" src="/static/images/9/thunderbird-outlook-config-.png" alt="Thunderbird Configure Outlook Account"> <figcaption>Thunderbird Account Configuration for Outlook</figcaption> </figure> </li> <li> <p>Click Done and you will get following warning for <strong>unencrypted connection</strong>. This is because traffic between DavMail and Thunderbird is unencrypted. If both thunderbird and davmail is running on same machine then you <strong>need not to worry about this warning</strong>. You can check in <em>I understand the risks</em> and click Done. </p> <figure class="figure  top3 text-center"> <img class="img-fluid  float-left" src="/static/images/9/tb-unencrypted-warning.png" alt="Thunderbird Warning for Unencrypted Connections"> <figcaption>Thunderbird Encryption Warning</figcaption> </figure> </li> <li> <p>If you have provided all details correctly then you should be able to see your outlook emails in thunderbird. </p> <figure class="figure  top3 text-center"> <img class="img-fluid  float-left" src="/static/images/9/outlook-emails-tb.png" alt="Exchange Emails in Thunderbird"> <figcaption>Outlook Email in Thunderbird</figcaption> </figure> </li> </ol> </article> <article class="container top2" itemscope itemtype="https://schema.org/BlogPosting"> <h2><a href="/8/davmail-windows/">Install Davmail on Windows 7 without Admin Access</a></h2> <p title="17-12-08 18:36:54Z">Posted December 08, 2017</p> <p class="lead"> Before we begin with setup I assume that you have downloaded latest version of davmail for windows and <a href="/6/exchange-davmail/#download" title="Open source alternative to outlook exchange">understand working of davmail</a> to connect to the exchange server with <abbr title="Exchange Web Services"><code>EWS</code></abbr>. </p> <h3>Installation on Windows</h3> <p class="top1"> We will install Davmail version 4.8 on Windows 7. However you are free to install latest version of davmail. Installation steps will remain same for all other versions of windows. </p> <h3>Before we begin</h3> <div class="card"> <ul class="card-body"> <li class="top1"> Davmail is written in <code>Java</code> and requires <abbr title="Java Runtime Environment"><code>JRE</code></abbr> for installation. Windows should have latest version of Java installed but in case it's not installed then Davmail setup will install Java during installation . Bottom line is you <em>don't need to install anything manually</em>. </li> <li class="top1"> The good part of installation is you <b>don't require admin rights</b> to get davmail running on windows. </li> </ul> </div> <h3 class="top2">DavMail Installation</h3> <ol> <li>Run downloaded davmail exe file. <code>davmail-4.8.0-2479-setup.exe</code></li> <li class="top2">Select Language</li> <figure class="figure text-center top3"> <img class="img-fluid" src="/static/images/8/1-language.png" alt="Davmail Setup : Select English Language"> <figcaption>Select Installation Language</figcaption> </figure> <li class="top2">Click Next and Accept Agreement</li> <figure class="figure text-center top3"> <img class="img-fluid" src="/static/images/8/2-next.png" alt="Davmail Installation Dialogbox : Next"> <figcaption>Click Next</figcaption> </figure> <figure class="figure text-center top1"> <img class="img-fluid" src="/static/images/8/3-license-agreement.png" alt="Davmail Installation Dialogbox : License Agreement"> <figcaption>Accept License Agreement</figcaption> </figure> <li class="top2">Path For installation</li> <figure class="figure text-center top3"> <img class="img-fluid" src="/static/images/8/4-installation-path.png" alt="Davmail Installation Dialogbox : Installation folder path"> <figcaption>Provide Manual Installation Path</figcaption> </figure> <div class="alert  alert-warning"> <p>If you don't have an admin access then please provide path accessible by you for <strong>read, write and execute</strong>.</p> </div> <li class="top2">Installation Succeeded</li> <figure class="figure text-center top3"> <img class="img-fluid" src="/static/images/8/5-installation-completed.png" alt="Davmail Installation Dialogbox : Completed"> <figcaption>Davmail Installed on Windows 7</figcaption> </figure> </ol> <h3>DavMail Configuration GUI</h3> <div class="text-center"> <figure class="figure  top3"> <img class="img-fluid text-center" src="/static/images/8/6-davmail-default-config.png" alt="Davmail Exchange Configuration Window: Default Configs"> <figcaption>Davmail Windows 7 Exchange Default Configuration</figcaption> </figure> </div> <div class="card"> <p class="lead card-body">Once installation completed you would see above window to configure DavMail with exchange mailbox. We will change this configuration to <a href="/9/thunderbird-exchange-davmail/" title="Davmail Outlook Configuration">setup exchange account with Thunderbird</a> in next post. </p> </div> </article> <article class="container top2" itemscope itemtype="https://schema.org/BlogPosting"> <h2><a href="/7/davmail-linux/">How to Install Davmail on Linux</a></h2> <p title="17-12-05 16:23:54Z">Posted December 05, 2017</p> <p class="lead"> Previously we discussed how davmail can be used to access exchange emails without webmail or outlook. In this post we will learn how we can install it on Linux. I assume that you have downloaded <a href="/6/exchange-davmail/#download" title="Download davmail">davmail for your platform</a> in last post. Now we will install DavMail Version 4.8 on Linux (Ubutnu, Debian and non debian ditros). However, you are free to install latest available version. </p> <div class="alert alert-warning"> <p>Note that Davmail is not presnt in official repository of any distribution hence we will need install it manually from package.</p> </div> <h3 id="ubuntu">Ubuntu Installation</h3> <p>Double click on downloaded debian file <code>davmail_4.8.0.3-2488-1_all.deb</code> to begin installation. It will open installation in <em>Ubuntu Software Center</em>. Click on Install and <em>wollah guess what</em> davmail is installed on Ubuntu.</p> <div class="text-center"> <figure calss="figure"> <img class="img-fluid" src="/static/images/7/davmail-ubuntu-software-center.png" alt="Ubuntu Software Center Window for Davmail"> <figcaption>Davmail on Ubuntu Software Center</figcaption> </figure> </div> <h3 id="debian" class="top2">Debian Installation</h3> <p> You can install same deb file <code>davmail_4.8.0.3-2488-1_all.deb</code> on Debian distros from command line using <code>apt</code>. If you have downloaded file then place it in <code>download</code> directory then use following command to auto complete installation. </p> <pre><code class="bash">cd Download
sudo apt install ./davmail_4.8.0.3-2488-1_all.deb
</code></pre> <h3 id="linux" class="top2">Linux Installation</h3> <p>If you are using non debian distributions like Fedora, Red Hat, openSUSE etc. then you can install DavMail from tarball. Place downloaded tarball file <code>davmail-linux-x86_64-4.8.0-2479.tgz</code> into <code>download</code> directory and use following commands. </p> <div class="card"> <p class="card-body">Note that this method <strong>does not require root access</strong> and can be used with <em>all linux distributions</em>.</p> </div> <ol class="top3"> <li>Extract and unzip tarball.</li> <pre><code class="bash">cd Download
tar xvfz davmail-linux-x86_64-4.8.0-2479.tgz 
</code></pre> <li>It should create new directory <code>davmail-linux-x86_64-4.8.0-2479</code> containing setup files inside it.</li> <pre><code class="bash">ls davmail-linux-x86_64-4.8.0-2479/

davmail.jar  davmail.sh  lib
</code></pre> <li>Execute <code>davmail.sh</code> to launch</li> <pre><code class="bash">sh davmail.sh
</code></pre> </ol> <h3 class="top2">Davmail Configuration</h3> <p>Once installed it would open exchange configuration window.</p> <div class="text-center"> <figure calss="figure"> <img class="img-fluid" src="/static/images/7/linux-davmail-exchange-configuration.png" alt="Davmail configuration wizard in Ubuntu"> <figcaption>Davmail Exchange Default Configuration</figcaption> </figure> </div> <p>Davmail would also create configuration file <code>.davmail.properties</code> and log file <code>davmail.log</code> inside home directory. </p> <ul> <li>Log FIle</li> <pre><code class="bash">cd ~
ls davmail.log

davmail.log
</code></pre> <li>Configuration FIle</li> <pre><code class="bash">cd ~
ls .davmail.properties

.davmail.properties
</code></pre> </ul> <div class="card"> <p class="card-body lead">In the future post we will <a href="/9/thunderbird-exchange-davmail" title="Davmail Exchange Configuration">configure davmail with exchange</a> and use Thunderbird to access mails.</p> </div> <h3 id="server" class="top3">Davmail as a Server without GUI</h3> <p>If you are running linux server or don't have access to GUI then you can run davmail as standalone server. To configure davmail you would need to manually edit <code>.davmail.properties</code> file. </p> <p>To run davmail as standalone server perform same <a href="#linux">linux installation</a> and use following command. <p> <pre><code class="bash">sh davmail.sh ~/.davmail.properties &</code></pre> <p>To run it in background run following command. It would send davmail output to nohup.out</p> <pre><code class="bash">nohup sh davmail.sh ~/.davmail.properties &</code></pre> </article> <article class="container top2" itemscope itemtype="https://schema.org/BlogPosting"> <h2><a href="/6/exchange-davmail/">How to access exchange mails with Davmail</a></h2> <p title="17-12-03 14:06:41Z">Posted December 03, 2017</p> <p class="lead">Traditionally email servers have used protocols like <code>SMTP</code>, <code>IMAP</code> and <code>POP</code> for email sending and delivery. However Microsoft has integrated own protocol in exchange mail server which requires proprietary client like outlook or webmail to access emails and other services like calendar and contacts. In majority of corporate exchange setup important email ports remain inaccessible from outside VPN connection so you cannot connect directly to the exhange server with free mail client like Thunderbird unless you have some middleware between mail client and exchange server that is able to communicate using exchange web services. Fortunately there is <mark>Davmail</mark>. </p> <h3>How Davmail Works ?</h3> <p>Davmail is free and open source software written in java that sits between mail client and exhange server. It connects to the exchange server using exchange web services <code>(EWS)</code> and provides an output in standard mail protocol like <code>SMTP</code>, <code>IMAP</code> and <code>POP</code>. Davmail is available on all three major platform Linux, Mac and Windows. Davmail can be installed on the <b>same machine</b> running mail client or on some other machine as <b>Davmail server</b>. </p> <figure class="text-center"> <img class="img-fluid" src="/static/images/6/davmail-architecture.png" alt="Local computer connecting to exchange server using davmail"> <figcaption class="figure-caption text-center">Simple Davmail Setup</figcaption> </figure> <h3>What do you get with Davmail ?</h3> <p>With Davmail you get following essential features implemented in exchange server</p> <div class="card"> <ul class="card-body"> <li>Email Transmission with <code>SMTP</code></li> <li>Mailbox Access with <code>IMAP</code></li> <li>Mailbox Access with <code>POP</code></li> <li>Exchange Contacts with <code>LDAP</code></li> <li>Exchange Calendar with <code>CalDav</code></li> <li>Web application Interface (optional)</code></li> </ul> </div> <h3 class="top2">Security</h3> <p>Communication between davmail and exchange server would be encrypted if <code>SSL</code> is configured for mail server (<code>https</code>)</p> <p>Communication between mail client and davmail is not encrypted by default but davmail gives you an option to configure encryption. If you are running both mail client and davmail on same machine then encryption is not required but you may consider having local SSL certificate if you are running davmail as a standalone server in your organization.</p> <h3 class="top1" id="download">Download</h3> <p class="lead">Install latest release version of DavMail for your platform from <a href="https://sourceforge.net/projects/davmail/files/davmail/" target="_blank" title="Download Davmail">davmail repository</a>. </p> <table class="table"> <thead> <tr> <th>Platform</th> <th>Filename</th> </tr> </thead> <tbody> <tr> <td>Linux (Ubuntu, Debian)</td> <td><code>davmail_4.8.0.3-2488-1_all.deb</code></td> </tr> <tr> <td>Linux (All distros)</td> <td><code>davmail-linux-x86_64-4.8.0-2479.tgz</code></td> </tr> <tr> <td>Mac</td> <td><code>DavMail-MacOSX-4.8.0.3-2484.app.zip</code></td> </tr> <tr> <td>Windows</td> <td><code>davmail-4.8.0-2479-setup.exe</code></td> </tr> </tbody> </table> <div class="card"> <p class="card-body">In future posts we will <a href="/7/davmail-linux/" title="DavMail Linux Installation">install davmail on Linux</a> and <a href="/8/davmail-windows/" title="Install DavMail on Windows">Windows</a>. Mac users can find linux installation useful. Once installed we will <a href="/9/thunderbird-exchange-davmail/" title="Configure DavMail with Thunderbird">setup DavMail with Thunderbird</a> <strong>in all environments</strong>. </p> </div> </article> <div class="top3"> </div> </main> <aside class="col-lg-2" id="sidebar"> <h3>Tags</h3> <nav> <ul> <li><a href="/tag/Davmail/" title="Davmail Setup and Configuration">Davmail</a></li> <li><a href="/tag/Flask/" title="Flask Web Development">Flask</a></li> <li><a href="/tag/Matplotlib%20/" title="Matplotlib Examples and Tutorials">Matplotlib </a></li> <li><a href="/tag/Open-Source/" title="Tutorials about open source software ">Open-Source</a></li> <li><a href="/tag/Python/" title="Python Programming">Python</a></li> <li><a href="/tag/Thunderbird/" title="Thunderbird Tutorials">Thunderbird</a></li> <li><a href="/tag/Ubuntu/" title="Ubuntu Tutorials">Ubuntu</a></li> <li><a href="/tag/Windows/" title="Windows Software and Tutorials">Windows</a></li> </ul> </nav> </aside> </div> <div class="top3"></div> </div> <link rel="stylesheet" type="text/css" href="/static/css/style.css"> <script src="/static/js/scripts.js" type="text/javascript"></script> <script type="text/javascript">hljs.initHighlightingOnLoad();</script> </body> </html>